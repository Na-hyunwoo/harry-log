---
title: CSR / SSR with Next.js
date: '2022-10-04'
tags: ['next-js']
draft: false
summary: 'ê¸°ì¡´ì— ì›¹ í˜ì´ì§€ëŠ” Serverì—ì„œ ë°›ì€ htmlì„ ë°”íƒ•ìœ¼ë¡œ Clientê°€ í™”ë©´ì„ ê·¸ë ¸ì§€ë§Œ, CSR ë°©ì‹ì€ ì„œë²„ì—ì„œ ë°›ëŠ”ê²Œ ì•„ë‹ˆë¼ Clientì—ì„œ ì•Œì•„ì„œ í™”ë©´ì„ ê·¸ë¦¬ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. Reactë‚˜ Vueê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬/í”„ë ˆì„ì›Œí¬ëŠ” SPAë¥¼ ë§Œë“œëŠ” ê²ƒì„ ì§€ì›í•˜ê³  CSR ë°©ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.'
---

### CSR(Client-side Rendering)ì´ë€ ë¬´ì—‡ì´ë©°, ê·¸ê²ƒì˜ ì¥ë‹¨ì 

**CSRì´ë€**

ê¸°ì¡´ì— ì›¹ í˜ì´ì§€ëŠ” Serverì—ì„œ ë°›ì€ htmlì„ ë°”íƒ•ìœ¼ë¡œ Clientê°€ í™”ë©´ì„ ê·¸ë ¸ì§€ë§Œ, CSR ë°©ì‹ì€ ì„œë²„ì—ì„œ ë°›ëŠ”ê²Œ ì•„ë‹ˆë¼ **Clientì—ì„œ ì•Œì•„ì„œ í™”ë©´ì„ ê·¸ë¦¬ëŠ” ë°©ì‹**ì…ë‹ˆë‹¤. Reactë‚˜ Vueê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬/í”„ë ˆì„ì›Œí¬ëŠ” SPAë¥¼ ë§Œë“œëŠ” ê²ƒì„ ì§€ì›í•˜ê³  CSR ë°©ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

CSR ë°©ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ì‚¬ì´íŠ¸ëŠ” urlì— ì ‘ê·¼ì„ í•˜ë©´ ì„œë²„ë¡œë¶€í„° body íƒœê·¸ ì•ˆì— `<div id = â€œrootâ€></div>`ì™€ applicationì—ì„œ í•„ìš”í•œ **js íŒŒì¼ ë§í¬**ë§Œ ë“¤ì–´ ìˆëŠ” í˜•íƒœì˜ **html íŒŒì¼ì„ ì‘ë‹µ** ë°›ìŠµë‹ˆë‹¤. ì‘ë™ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

1. ì‚¬ì´íŠ¸ì— ì ‘ì†í•©ë‹ˆë‹¤.
2. htmlì€ ë¹„ì–´ìˆê¸° ë•Œë¬¸ì— ì²˜ìŒì—ëŠ” ë¹ˆ í™”ë©´ì´ ë³´ì´ê²Œ ë©ë‹ˆë‹¤.
3. ë§í¬ëœ js íŒŒì¼ì„ ì„œë²„ë¡œë¶€í„° ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤. ì´ js íŒŒì¼ì—ëŠ” ìš°ë¦¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì— í•„ìš”í•œ ë¡œì§ë“¤ ë¿ë§Œ ì•„ë‹ˆë¼ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ë™í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì™€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì†ŒìŠ¤ì½”ë“œë“¤ë„ ë‹¤ í¬í•¨ì´ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì‚¬ì´ì¦ˆê°€ êµ‰ì¥íˆ ì»¤ì„œ ë‹¤ìš´ë¡œë“œ ë°›ëŠ”ë° ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. ì¶”ê°€ë¡œ í•„ìš”í•œ ë°ì´í„°ê°€ ìˆì„ ê²½ìš° ì„œë²„ë¡œ ìš”ì²­í•´ì„œ JSON ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ ë‹¤ìŒ js íŒŒì¼ê³¼ ë™ì ìœ¼ë¡œ htmlì„ ìƒì„±í•´ì„œ ì‚¬ìš©ìì—ê²Œ í™”ë©´ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

ê°œë°œìë„êµ¬ Networks íƒ­ì— ê°€ë³´ë©´ ì„œë²„ì—ì„œ ë°›ì€ htmlì€ ë‚´ìš©ì´ ë¹„ì–´ ìˆëŠ”ë° ê°œë°œì ë„êµ¬ Elements íƒ­ì— ê°€ë³´ë©´ `<div id=â€rootâ€></div>` íƒœê·¸ ì•ˆì— ë‹¤ë¥¸ íƒœê·¸ë“¤ì´ ë“¤ì–´ê°€ ìˆìŠµë‹ˆë‹¤. ì´ íƒœê·¸ë“¤ì€ ë²ˆë“¤ë§ëœ js íŒŒì¼ì„ í†µí•´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.

ë¦¬ì•¡íŠ¸ëŠ” buildë¥¼ í•  ë•Œ í”„ë¡œì íŠ¸ ë‚´ì˜ ëª¨ë“  ë¦¬ì•¡íŠ¸ ì½”ë“œë¥¼ í•˜ë‚˜ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. (babelë¡œ transpiling, webpackìœ¼ë¡œ bundling)

CSRì„ ì‚¬ìš©í•˜ë©´ ì´ˆê¸° í˜ì´ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```jsx
<html>
  <head>
    <script src="client-side-framework.js"></script>
    <script src="app.js"></script>
  </head>
  <body>
    <div class="container"></div>
  </body>
</html>
```

app.jsëŠ” Javascriptì˜ ëª¨ë“  HTML í˜ì´ì§€ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë¬¸ìì—´ë¡œ ìœ ì§€í•©ë‹ˆë‹¤.

```jsx
var pages = {
  '/': '<html> ... </html>',
  '/foo': '<html> ... </html>',
  '/bar': '<html> ... </html>',
}
```

ê·¸ëŸ° ë‹¤ìŒ í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ í”„ë ˆì„ì›Œí¬ëŠ” URL í‘œì‹œì¤„ì„ ë³´ê³  [â€™/â€™]í˜ì´ì§€ì—ì„œ ë¬¸ìì—´ì„ ê°€ì ¸ì™€ì„œ

```jsx
<div class="container"> </div>
```

ì— ì‚½ì…í•©ë‹ˆë‹¤. ë˜í•œ ë§í¬ë¥¼ í´ë¦­í•˜ë©´ í”„ë ˆì„ì›Œí¬ê°€ ì´ë²¤íŠ¸ë¥¼ ê°€ë¡œ ì±„ê³  ì»¨í…Œì´ë„ˆì— ìƒˆ ë¬¸ìì—´ (ì˜ˆ : í˜ì´ì§€ [â€™/fooâ€™])ì„ ì‚½ì…í•˜ê³  ë¸Œë¼ìš°ì €ê°€ ì •ìƒì ìœ¼ë¡œ í•˜ëŠ”ê²ƒì²˜ëŸ¼ HTTP ìš”ì²­ì„ ì‹¤í–‰í•˜ì§€ ëª»í•˜ê²Œ í•©ë‹ˆë‹¤.

**ì •ë¦¬**

1. ServerëŠ” bodyíƒœê·¸ ì•ˆì— ë¹„ì–´ìˆëŠ” divíƒœê·¸ í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ëŠ” htmlì„ ì‘ë‹µí•©ë‹ˆë‹¤.
2. Clientì—ì„œ bundle.jsë¥¼ ì½ê³  DOMì„ ê·¸ë¦½ë‹ˆë‹¤.
3. ì‚¬ì´íŠ¸ ë‚´ì—ì„œ ë¼ìš°íŒ… ì²˜ë¦¬í•œ urlë¡œ ì´ë™ì„ í•˜ë”ë¼ë„ ì„œë²„ë¡œë¶€í„° ìƒˆë¡œìš´ htmlì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤.
4. bundle.jsì— ëª¨ë“  ì½”ë“œê°€ ë‹¤ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— Clientì—ì„œ ë³€ê²½ëœ urlì— ë§ëŠ” ì½”ë“œë¥¼ bundle.jsì—ì„œ ì°¾ì•„ì„œ ê·¸ë¦½ë‹ˆë‹¤.

**ì¥ì **

- ì›¹ì„ ì•±ê³¼ ë¹„ìŠ·í•œ ê²½í—˜ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- urlì´ ë°”ë€Œì–´ë„ htmlì„ ë‹¤ì‹œ ë‚´ë ¤ë°›ì§€ ì•Šê³  Clientì—ì„œ ì•Œì•„ì„œ ê·¸ë¦½ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ˆê¸° í˜ì´ì§€ ë¡œë“œ í›„ì—ëŠ” ëª¨ë“  í˜ì´ì§€ë¡œë“œê°€ ì—„ì²­ë‚˜ê²Œ ë¹ ë¦…ë‹ˆë‹¤.

**ë‹¨ì **

- í”„ë¡œì íŠ¸ì˜ í¬ê¸°ê°€ ì»¤ì§ì— ë”°ë¼ ì½”ë“œê°€ ë§ì•„ì§€ë©´ ë²ˆë“¤ë§ëœ í•˜ë‚˜ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì˜ í¬ê¸°ê°€ ì»¤ì§‘ë‹ˆë‹¤. ì´ íŒŒì¼ì˜ í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ì´ˆê¸°ì— íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ˆê¸° í˜ì´ì§€ ë¡œë“œê°€ ëŠë ¤ì§‘ë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©ìê°€ ì²« í™”ë©´ì„ ë³´ê¸°ê¹Œì§€ ì˜¤ë˜ ê±¸ë¦¼ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- SEO ìµœì í™”ê°€ í˜ë“­ë‹ˆë‹¤.
  - ëŒ€ë¶€ë¶„ì˜ ê²€ìƒ‰ë´‡ì´ htmlì„ ê¸°ë°˜ìœ¼ë¡œ ìš”ì†Œë¥¼ ì°¾ê¸° ë•Œë¬¸ì— ë¹ˆ htmlì„ ë‚´ë ¤ì£¼ëŠ” CSRì„ ì‚¬ìš©í•˜ë©´ SEO ìµœì í™”ê°€ í˜ë“¤ì–´ì§‘ë‹ˆë‹¤.

### SPA(Single Page Application)ë¡œ êµ¬ì„±ëœ ì›¹ ì•±ì—ì„œ SSR(Server-side Rendering)ì´ í•„ìš”í•œ ì´ìœ 

ìœ„ì—ì„œ ë§í•œ ê²ƒì²˜ëŸ¼ ëŒ€ë¶€ë¶„ì˜ ê²€ìƒ‰ ë´‡ì€ htmlì„ ê¸°ë°˜ìœ¼ë¡œ ìš”ì†Œë¥¼ ì°¾ê¸° ë•Œë¬¸ì— ë¹ˆ htmlì„ ë‚´ë ¤ì£¼ëŠ” CSRì„ ì‚¬ìš©í•˜ë©´ SEO ìµœì í™”ê°€ í˜ë“¤ì–´ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ SSRì´ í•„ìš”í•©ë‹ˆë‹¤.

### Next.js í”„ë¡œì íŠ¸ë¥¼ ì„¸íŒ…í•œ ë’¤ yarn start ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ

- [Next.js Github ë ˆí¬ì§€í† ë¦¬](https://github.com/vercel/next.js/)

**next-start.ts**

```jsx
#!/usr/bin/env node

import arg from 'next/dist/compiled/arg/index.js'
import { startServer } from '../server/lib/start-server'
import { getPort, printAndExit } from '../server/lib/utils'
import * as Log from '../build/output/log'
import isError from '../lib/is-error'
import { getProjectDir } from '../lib/get-project-dir'
import { cliCommand } from '../lib/commands'

const nextStart: cliCommand = (argv) => {
  const validArgs: arg.Spec = {
    // Types
    '--help': Boolean,
    '--port': Number,
    '--hostname': String,
    '--keepAliveTimeout': Number,

    // Aliases
    '-h': '--help',
    '-p': '--port',
    '-H': '--hostname',
  }
  let args: arg.Result<arg.Spec>
  try {
    args = arg(validArgs, { argv })
  } catch (error) {
    if (isError(error) && error.code === 'ARG_UNKNOWN_OPTION') {
      return printAndExit(error.message, 1)
    }
    throw error
  }
  if (args['--help']) {
    console.log(`
      Description
        Starts the application in production mode.
        The application should be compiled with \`next build\` first.

      Usage
        $ next start <dir> -p <port>

      <dir> represents the directory of the Next.js application.
      If no directory is provided, the current directory will be used.

      Options
        --port, -p      A port number on which to start the application
        --hostname, -H  Hostname on which to start the application (default: 0.0.0.0)
        --keepAliveTimeout  Max milliseconds to wait before closing inactive connections
        --help, -h      Displays this message
    `)
    process.exit(0)
  }

  const dir = getProjectDir(args._[0])
  const host = args['--hostname'] || '0.0.0.0'
  const port = getPort(args)

  const keepAliveTimeoutArg: number | undefined = args['--keepAliveTimeout']
  if (
    typeof keepAliveTimeoutArg !== 'undefined' &&
    (Number.isNaN(keepAliveTimeoutArg) ||
      !Number.isFinite(keepAliveTimeoutArg) ||
      keepAliveTimeoutArg < 0)
  ) {
    printAndExit(
      `Invalid --keepAliveTimeout, expected a non negative number but received "${keepAliveTimeoutArg}"`,
      1
    )
  }

  const keepAliveTimeout = keepAliveTimeoutArg ? Math.ceil(keepAliveTimeoutArg) : undefined

  startServer({
    dir,
    hostname: host,
    port,
    keepAliveTimeout,
  })
    .then(async (app) => {
      const appUrl = `http://${app.hostname}:${app.port}`
      Log.ready(`started server on ${host}:${app.port}, url: ${appUrl}`)
      await app.prepare()
    })
    .catch((err) => {
      console.error(err)
      process.exit(1)
    })
}

export { nextStart }
```

next startë¼ëŠ” ì»¤ë§¨ë“œë¼ì¸ì´ ì…ë ¥ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

next startëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì‹œì‘í•˜ê²Œ í•´ì¤ë‹ˆë‹¤. ë‹¨, next startì´ì „ì— ë°˜ë“œì‹œ next buildê°€ ì„ í–‰ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. (ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‹¤í–‰ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)

â€”help, â€”portì™€ ê°™ì´ next start ë’¤ì— ì…ë ¥í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì— ëŒ€í•œ ì„¤ëª…ì´ ì í˜€ìˆìŠµë‹ˆë‹¤.

ë¦¬ì•¡íŠ¸ì˜ ê²½ìš° yarn startë¥¼ í–ˆì„ ì‹œì— í˜„ì¬ ì‚¬ìš©ì¤‘ì´ì§€ ì•Šì€ port ë„˜ë²„ë¥¼ ì•Œì•„ì„œ ì°¾ì•„ì¤ë‹ˆë‹¤. ë°˜ë©´ì—, nextëŠ” ê·¸ëŸ¬ì§€ ì•Šì•„ì„œ ë¶ˆí¸í•˜ë‹¤ê³  ìƒê°í•˜ê³  ìˆì—ˆëŠ”ë°, â€”portë¥¼ í†µí•´ port ë„˜ë²„ë¥¼ ì§€ì •í•´ì¤„ ìˆ˜ ìˆìœ¼ë‹ˆ ì•ìœ¼ë¡œëŠ” port ë„˜ë²„ë¥¼ ì§€ì •í•´ì„œ ì»¤ë§¨ë“œ ë¼ì¸ì„ ì‹¤í–‰í•´ì•¼ê² ìŠµë‹ˆë‹¤.

ì½˜ì†”ì—

![csr-ssr-with-next-js-log](/static/images/csr-ssr-with-next-js-log.png)

ë‹¤ìŒê³¼ ê°™ì€ ë¡œê·¸ë„ ì´ íŒŒì¼ì—ì„œ ì°ì–´ì¤ë‹ˆë‹¤.

ì´ë ‡ê²Œ next startì‹œì— ì‹¤í–‰ë˜ëŠ” íŒŒì¼ì„ ì§ì ‘ ë³´ë‹ˆ ì´ í•˜ë‚˜ì˜ cliì— ëŒ€í•´ì„œ êµ‰ì¥íˆ ê¹Šê²Œ ì•Œê²Œë˜ì—ˆìŠµë‹ˆë‹¤. nextë¼ëŠ” í”„ë ˆì„ì›Œí¬ì— ìµìˆ™í•˜ì§€ ì•Šì•„ ì´ íŒŒì¼ì˜ ëª¨ë“  ìš”ì†Œë¥¼ ì´í•´í•˜ëŠ” ê²ƒì€ ì–´ë µì§€ë§Œ (í•´ì„¤ ë¶€íƒë“œë¦½ë‹ˆë‹¤ìš”ğŸ¥¹) í”„ë ˆì„ì›Œí¬ë¥¼ ë” ê¹Šê²Œ ì´í•´í•˜ê¸° ìœ„í•œ í•˜ë‚˜ì˜ ë°©ë²•ì„ ë°°ìš´ ê²ƒ ê°™ì•„ì„œ ê¸°ë¶„ì´ ì¢‹ìŠµë‹ˆë‹¤. â˜ºï¸

### ë ˆí¼ëŸ°ìŠ¤

[[ë²ˆì—­] Client-side rendering VS. Server-sde rendering](https://jongmin92.github.io/2017/06/06/JavaScript/client-side-rendering-vs-server-side-rendering/)

[NAVER D2](https://d2.naver.com/helloworld/7804182)

[[WEB] Client Side Renderingê³¼ Server Side Rendering](https://jess2.xyz/web/csr-ssr/)

[What's the difference between npm run dev and npm run start in Next.js?](https://stackoverflow.com/questions/69400243/whats-the-difference-between-npm-run-dev-and-npm-run-start-in-next-js)
